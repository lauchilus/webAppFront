<div class="bg-gradient-to-r from-gray-900 to-violet-500 min-h-screen">
    <div class="flex-wrap container justify-between m-auto pt-24">

        <div class="flex-wrap container px-60">
            <div class="flex flex-wrap justify-between gap-4">
                <div class=" flex items-center space-x-4">
                    <img class="w-24 h-24 rounded-full" src="{{profilePic}}" alt="Rounded avatar">
                    <div>

                        <p class=" text-whitefont-semibold text-center font-medium text-4xl">{{username}}</p>



                    </div>


                    <div class="m-5">
                        <button (click)="editPopup=!editPopup"
                            class="flex p-2.5 bg-pink-500 rounded-xl hover:rounded-3xl hover:bg-pink-600 transition-all duration-300 text-white">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                            </svg>
                        </button>

                        @if (editPopup) {
                        <div class="fixed top-0 left-0 w-full h-full flex items-center justify-center bg-black bg-opacity-50 text-white z-30"
                            (click)="closePopup($event)">
                            <div class="bg-gray-700 p-8 rounded " (click)="stopPropagation($event)">
                                <form [formGroup]="myform" class="max-w-lg mx-auto">
                                    <label class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
                                        for="user_avatar">Upload file</label>
                                    <input (change)="onFileSelected($event)"
                                        class="block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 dark:text-gray-400 focus:outline-none dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400"
                                        aria-describedby="user_avatar_help" id="user_avatar" type="file">
                                    <div class="mt-1 text-sm text-gray-500 dark:text-gray-300" id="user_avatar_help">A
                                        profile picture.</div>

                                    <div>
                                        <label for="website-admin"
                                            class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Username</label>
                                        <div class="flex">
                                            <span
                                                class="inline-flex items-center px-3 text-sm text-gray-900 bg-gray-200 border border-e-0 border-gray-300 rounded-s-md dark:bg-gray-600 dark:text-gray-400 dark:border-gray-600">
                                                <svg class="w-4 h-4 text-gray-500 dark:text-gray-400" aria-hidden="true"
                                                    xmlns="http://www.w3.org/2000/svg" fill="currentColor"
                                                    viewBox="0 0 20 20">
                                                    <path
                                                        d="M10 0a10 10 0 1 0 10 10A10.011 10.011 0 0 0 10 0Zm0 5a3 3 0 1 1 0 6 3 3 0 0 1 0-6Zm0 13a8.949 8.949 0 0 1-4.951-1.488A3.987 3.987 0 0 1 9 13h2a3.987 3.987 0 0 1 3.951 3.512A8.949 8.949 0 0 1 10 18Z" />
                                                </svg>
                                            </span>
                                            <input formControlName="username" matInput type="text" id="website-admin"
                                                class="rounded-none rounded-e-lg bg-gray-50 border border-gray-300 text-gray-900 focus:ring-blue-500 focus:border-blue-500 block flex-1 min-w-0 w-full text-sm p-2.5  dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                                                placeholder="Enter Username">
                                        </div>
                                    </div>

                                    <div>
                                        <label for="message"
                                            class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Your
                                            Bio</label>
                                        <textarea formControlName="bio" matInput id="message" rows="4"
                                            class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                                            placeholder="Leave a comment..."></textarea>

                                    </div>
                                </form>

                                <button (click)="editProfile()"
                                    class='bg-pink-500 text-white px-4 py-2 mt-4 rounded m-auto'>Create</button>
                                <button (click)="editPopup=!editPopup"
                                    class="bg-pink-500 text-white px-4 py-2 mt-4 rounded m-auto">Cancel</button>

                            </div>
                        </div>


                        }



                    </div>


                </div>
                <div class="flex space-x-2 justify-between items-center mx-9 text-center mt-14">
                    <div class="">
                        <h3 class=" font-mono">Total Reviews</h3>
                        <p class="font-mono text-neutral-200 text-4xl">{{ totalReviewsFromApi }}</p>
                    </div>

                    <div class="">
                        <h3 class="font-mono">Total Played</h3>
                        <p class="font-mono text-neutral-200 text-4xl">{{ totalPlayedFromApi }}</p>
                    </div>

                    <div class="">
                        <h3 class="font-mono">Total Backlog</h3>
                        <p class="font-mono text-neutral-200 text-4xl">{{ totalBacklogFromApi }}</p>
                    </div>
                </div>

            </div>
            <h2 class=" text-whitefont-semibold text-left font-medium text-4xl pt-10">Bio</h2>
            <p class=" text-whitefont-semibold text-left font-thin text-sm max-w-md break-words text-white">{{bio}}</p>
        </div>



        <div class="flex justify-center pt-12 ">
            <nav class="border-2 border-fuchsia-900  p-5">
                <div class="container flex justify-between items-center">
                    <ul class="flex space-x-2">

                        <li><a href="/profile/reviews/{{idParam}}"
                                class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 md:dark:hover:text-blue-500 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700">Reviews</a>
                        </li>
                        <li><a href="/profile/backlog/{{idParam}}"
                                class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 md:dark:hover:text-blue-500 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700">Backlog</a>
                        </li>
                        <li><a href="/profile/played/{{idParam}}"
                                class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 md:dark:hover:text-blue-500 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700">Played</a>
                        </li>

                        <li><a href="/profile/lists/{{idParam}}"
                                class="block py-2 px-3 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700 md:p-0 md:dark:hover:text-blue-500 dark:text-white dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent dark:border-gray-700">Lists</a>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>


        <div class="grid grid-cols-2 gap-4 px-24 mt-4 auto-rows-max">
            <div class="justify-self-auto">
                <h2 class="text-left inline-block align-baseline underline underline-offset-1 text-purple-300">Favorites
                </h2>
            </div>
            <div class="text-right underline underline-offset-1 text-purple-300">
                <a href="/profile/favorites/{{userId}}">edit favs</a>
            </div>

            <div class="col-span-2 flex justify-center flex-row flex-nowrap gap-4 items-center">
                @defer () {
                @for (fav of favGames; track fav.id) {
                <div>

                    <div
                        class="relative size-64 max-w-44 overflow-hidden rounded-xl bg-white bg-clip-border text-bottom text-gray-700 group transition-all duration-300 hover:border-yellow-500">
                        <a href="/details/{{fav.gameId}}">
                            <img alt=""
                                class="absolute inset-0 w-full h-full bg-cover bg-center text-gray-700 shadow-none object-cover aspect-square group-hover:scale-110 transition duration-300 ease-in-out"
                                src="{{fav.gameImageUrl}}" />
                        </a>
                    </div>

                </div>
                }
                }
                @placeholder () {
                <img class="w-12 h-12 rounded-full" alt="loading..."
                    src="https://i.gifer.com/origin/34/34338d26023e5515f6cc8969aa027bca.gif" />
                }
            </div>
            <!--FAVORITES-->

        </div>




        <!--LAST REVIEWS-->
        <div class="flex flex-wrap justify-between gap-4 mt-12 ml-28 pb-2">
            <div class="justify-self-auto">
                <h2 class="text-left inline-block align-baseline underline underline-offset-1 text-purple-300">Last
                    Reviews
                </h2>
            </div>
            <div class="text-right underline underline-offset-1 text-purple-300">
                <a href="/profile/favorites/{{userId}}">all</a>
            </div>
            <div class="container ml-80 ">
                <div class="flex flex-col w-auto gap-2">
                    @defer () {
                    @for (item of reviews; track item.gameId) {
                    <div
                        class="flex flex-row rounded-lg w-3/4 h-auto bg-zinc-900 text-surface shadow-secondary-1 dark:bg-surface-dark dark:text-white text-wrap">

                        <img class="h-96 w-full rounded-t-lg object-cover md:h-auto md:w-48 md:!rounded-none md:!rounded-s-lg"
                            src="{{item.gameImage}}" alt="cover image" />

                        <div class="flex flex-col justify-start p-6">
                            <h1 class="mb-2 text-xl font-medium">{{item.name}}</h1>
                            <div class="flex items-center">
                                @for (item of getRatingArray(item.rating); track $index) {
                                <svg class="w-4 h-4 text-yellow-300 ms-1" aria-hidden="true"
                                    xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 22 20">
                                    <path
                                        d="M20.924 7.625a1.523 1.523 0 0 0-1.238-1.044l-5.051-.734-2.259-4.577a1.534 1.534 0 0 0-2.752 0L7.365 5.847l-5.051.734A1.535 1.535 0 0 0 1.463 9.2l3.656 3.563-.863 5.031a1.532 1.532 0 0 0 2.226 1.616L11 17.033l4.518 2.375a1.534 1.534 0 0 0 2.226-1.617l-.863-5.03L20.537 9.2a1.523 1.523 0 0 0 .387-1.575Z" />
                                </svg>
                                }

                            </div>

                            <article class="text-wrap w-3/5">
                                <h3 class="mb-2 pt-2 text-xl font-medium">{{item.date | date: 'dd/MM/yyyy'}}</h3>
                                <p class="mb-4 text-ellipsis overflow-hidden">
                                    {{item.review}}
                                </p>
                            </article>
                            <a href="/reviews/{{item.id}}" class="bg-pink-600 hover:bg-rose-600 text-white font-bold py-2 px-4 rounded-full w-32">
                            See Review
                        </a>
                        </div>

                        


                    </div>


                    }
                    }

                    @placeholder () {
                    <img class="w-12 h-12 rounded-full m-auto" alt="loading..."
                        src="https://i.gifer.com/origin/34/34338d26023e5515f6cc8969aa027bca.gif" />
                    }
                </div>

            </div>

        </div>


    </div>
</div>